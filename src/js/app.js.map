{"version":3,"file":"app.js","sourceRoot":"","sources":["app.ts"],"names":[],"mappings":"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","sourcesContent":["\n$(document).ready(function () {\n    //State initialization\n    var $editor = $('#editor');\n    new Line().appendLine($editor, \"The <b>Splendor</b> of the King\");\n    new Line().appendLine($editor, \"Clothed in Majesty\");\n    new Line().appendLine($editor, \"Let all the earth rejoice\");\n    new Line().appendLine($editor, \"All the earth rejoice\");\n    //console.log($editor.html());\n});\n//this function is called each time a key is pressed inside a line_textarea\nfunction onKeyDown(event: KeyboardEvent, ths: HTMLDivElement) {\n    var key = event.key;\n    var $this = $(ths); //textarea\n    if (key == \"Enter\") {\n        enter($this);\n        event.preventDefault();\n    }\n    else if (key == \"Backspace\") {\n        if ($this.text().length == 0) {\n            deleteLine($this);\n            event.preventDefault();\n        }\n    }\n    else if (key == \"ArrowUp\") {\n        move($this, true);\n        event.preventDefault();\n    }\n    else if (key == \"ArrowDown\") {\n        move($this, false);\n        event.preventDefault();\n    }\n    //TODO ChordMenu.destroyIfExists();\n}\nfunction onKeyUp(event: KeyboardEvent, ths: HTMLTextAreaElement) {\n    try {\n        Line.get_line_from_$obj($(ths)).onKeyUp(event, $(ths));\n    }\n    catch (e) {\n        //ignore\n    }\n}\n//-----------\n//---Context menu--------\n//-----------\n(function () {\n    function init() {\n        clickListener();\n    }\n    function clickListener() {\n        document.addEventListener(\"click\", function (event) {\n            var button = event.which || event.button;\n            if (button === 1) {\n                ChordMenu.destroyIfExists();\n            }\n        });\n    }\n    init();\n})();\n//--------------\n//----Key commands in text box----\n//--------------\nfunction enter($this) {\n    //we need the id so we can find it to focus on after adding it\n    var lineObj = new Line();\n    $this = getParentLineDiv($this);\n    lineObj.afterLine($this);\n    $('#' + lineObj.mId).find('.line_textarea').focus();\n}\nfunction deleteLine($this) {\n    //if this isn't the only line, delete it\n    if ($('#editor').find('.line_div').length > 1) {\n        move($this, true);\n        //console.log(\"@! \" + $this);\n        Line.get_line_from_$obj($this).removeLine();\n    }\n}\n//move the cursor!\nfunction move($this, boolUp) {\n    var $lineDivs = $('#editor').find('.line_div'); //save an array of lines in editor\n    var thisID = Line.get_line_from_$obj($this).mId;\n    //set up directional variables\n    var limit = $lineDivs.length - 1;\n    var delta = 1;\n    if (boolUp) {\n        limit = 0;\n        delta = -1;\n    }\n    //Find the line we are on and switch focus to the line either above or below\n    $lineDivs.each(function (i, obj) {\n        if (thisID == $(obj).attr('id')) {\n            if (i == limit)\n                return; //can't go up past the last line\n            var $moveToBox = Line.get_line_from_$obj($($lineDivs.get(i + delta))).get$Textbox();\n            var cursorPos = getCaretCharacterOffsetWithin($this.get(0));\n            setCaretToPos($moveToBox, cursorPos);\n            return false;\n        }\n    });\n}\n//--------------------\n//---helper functions----\n//--------------------\nfunction getParentLineDiv($this) {\n    if ($this.attr('class') == 'line_div') {\n        return $this;\n    }\n    else {\n        var $parents = $this.parents();\n        //I don't love this solution, cause this will be a frequently used funciton that depends\n        //   on low hierarchy depth\n        if ($parents.length > 15) {\n            console.log(\"Warning: getParentLineDiv's $parents variable is \" + $parents.length +\n                \" long.  May need to rethink method?\");\n        }\n        var $return: JQuery = null;\n        $parents.each(function (i, obj) {\n            if ($(obj).attr('class') == 'line_div') {\n                $return = $(obj);\n                return false;\n            }\n        });\n        if ($return == null) {\n            throw new Error(\"getParentLineDiv on \" + $this + \" couldn't find a lineDiv\");\n        }\n        return $return;\n    }\n}\n//-----templates------\n"]}